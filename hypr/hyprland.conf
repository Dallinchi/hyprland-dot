#-------------------------------:--------------------------------------------------------
# НАСТРОЙКА ПЕРЕМЕННЫХ
# ---------------------------------------------------------------------------------------
$mainMod = SUPER
$browser = firefox
$wallpaper = python ~/Code/Projects/swaybg-queue
#---------------------------------------------------------------------------------------
# НАСТРОЙКА МОНИТОРОВ
# ---------------------------------------------------------------------------------------
# Моник Камиля
# monitor=HDMI-A-1,1920x1080,0x0,1,transform,0 
# monitor=eDP-1, 1920x1080,1920x1080, 1       
monitor=eDP-1, 1920x1080,900x360,1
monitor=HDMI-A-1,1440x900,0x0,1,transform,1
# monitor=HDMI-A-1,1440x900,0x0,1,transform,1, mirror, eDP-1
# Сохраняет ориентацию монитора при перезапуске
exec = ~/.config/hypr/scripts/monitors/orientation_keeper

#---------------------------------------------------------------------------------------
# АВТОЗАПУСК
#---------------------------------------------------------------------------------------
# exec-once = [workspace 1] firefox
# exec-once = [workspace 4] spotify
# exec-once = [workspace 5] telegram-desktop
# exec-once = easyeffects --gapplication-service

exec-once = python ~/Code/smallFeat/low_battery.py
exec-once = $wallpaper
exec-once = start_my_control_panel
exec-once = ~/.config/hypr/scripts/listeners/busy_timer_listener

exec-once = wireplumber
exec-once = pipewire-pulse
exec-once = pipewire
exec-once = dunst
# exec-once = waybar
# exec-once = waybar -c ~/.config/waybar/config_two_monitor -s ~/.config/waybar/style_two_monitor.css
exec-once = quickshell -c ~/.config/quickshell/lacrity-space
exec-once = blueman-applet
exec-once = wl-paste --type text --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store
exec-once = /usr/libexec/polkit-gnome-authentication-agent-1
exec-once = seafile-applet
# exec-once = gammastep -l 55.4:49.7 -t 3500:2000

exec-once = hyprctl setcursor BreezeX-Dark 24
exec-once = brightnessctl set 100%+

exec-once = hyprpm reload

#--------------------------------------------------------------------------------------
# ПОДКЛЮЧЕНИЕ ФАЙЛА КОНФИГУРАЦИИ
#---------------------------------------------------------------------------------------
# source = ~/.config/hypr/myColors.conf

#--------------------------------------------------------------------------------------
# ПЕРЕМЕННЫЕ ОКРУЖЕНИЯ
#--------------------------------------------------------------------------------------
env = QT_QPA_PLATFORMTHEME,qt6ct # change to qt6ct if you have that
env = XDG_CURRENT_DESKTOP="Hyprland";
env = XDG_SESSION_TYPE="wayland";
env = XDG_SESSION_DESKTOP="Hyprland";
env = QT_AUTO_SCREEN_SCALE_FACTOR="1";
env = QT_QPA_PLATFORM="wayland";
env = QT_QPA_PLATFORMTHEME="gtk3";


#---------------------------------------------------------------------------------------
# НАСТРОЙКА КЛАВИАТУРЫ
#---------------------------------------------------------------------------------------

input {
    kb_layout = us, ru
    kb_options = grp:alt_shift_toggle
    numlock_by_default = true
    repeat_delay = 250
    repeat_rate = 65

    touchpad {
        natural_scroll = yes
        disable_while_typing = true
        clickfinger_behavior = true
        scroll_factor = 0.4
    }
    special_fallthrough = true
    follow_mouse = 1
}
#
#---------------------------------------------------------------------------------------
# ГАПСЫ, БОРДЕРЫ, ЦВЕТА...
#---------------------------------------------------------------------------------------

general {
    # See https://wiki.hyprland.org/Configuring/Variables/ for more

    gaps_in = 5
    gaps_out = 10
    border_size = 1
    # col.active_border = rgba(70e6e0ff) rgba(28ece2ff) rgba(b1dad8ff)
    col.active_border = rgba(70e6e0ff) 
    col.inactive_border = rgba(2f343fff)
    layout = master
}


#---------------------------------------------------------------------------------------
# БЛЮРЫ, ТЕНИ, СКРУГЛЕНИЯ, ПРОЗРАЧНОСТЬ
#---------------------------------------------------------------------------------------
decoration {
    # See https://wiki.hyprland.org/Configuring/Variables/ for more

    rounding = 10
    blur {
      enabled = yes
      size = 4
      passes = 3
      new_optimizations = on


    }
    shadow {
      enabled = yes
      range = 10
      render_power = 2
      color = rgba(000214aa)


    }
    # Затемнение неактивных окон
    dim_inactive = 1
    dim_strength = 0.6
    
    # Прозрачность неактивных окон
    inactive_opacity = 0.9
}



#---------------------------------------------------------------------------------------
# АНИМАЦИЯ
#---------------------------------------------------------------------------------------
animations {
    enabled = yes
    # Animation curves

    bezier = md3_standard, 0.2, 0.0, 0, 1.0
    bezier = md3_decel, 0.05, 0.7, 0.1, 1
    bezier = md3_accel, 0.3, 0, 0.8, 0.15
    bezier = overshot, 0.05, 0.9, 0.1, 1.05
    bezier = hyprnostretch, 0.05, 0.9, 0.1, 1.0
    bezier = win10, 0, 0, 0, 0
    bezier = gnome, 0, 0.85, 0.3, 1
    bezier = funky, 0.46, 0.35, -0.2, 1.2
    # Animation configs
    animation = windows, 1, 2, md3_standard, slide
    # animation = borderangle, 1, 50, win10, loop
    animation = border, 1, 10, gnome
    animation = fade, 1, 0.01, hyprnostretch
    animation = workspaces, 1, 1, hyprnostretch, slidefade
    animation = specialWorkspace, 1, 5, hyprnostretch, fade
}


#---------------------------------------------------------------------------------------
# НАСТРОЙКА ПОВЕДЕНИЯ ОКОН
#---------------------------------------------------------------------------------------
dwindle {
    # See https://wiki.hyprland.org/Configuring/Dwindle-Layout/ for more
    pseudotile = yes # master switch for pseudotiling. Enabling is bound to mainMod + P in the keybinds section below
    preserve_split = yes # you probably want this
}

master {
    # See https://wiki.hyprland.org/Configuring/Master-Layout/ for more
    #new_is_master = true
    orientation = left
    allow_small_split = true
    mfact = 0.5
    new_status = inherit
}


#---------------------------------------------------------------------------------------
# ЖЕСТЫ
#---------------------------------------------------------------------------------------
gestures {
    # See https://wiki.hyprland.org/Configuring/Variables/ for more
    workspace_swipe=yes
    workspace_swipe_fingers=3
}


#---------------------------------------------------------------------------------------
# HYPRLAND ФИЧИ
#---------------------------------------------------------------------------------------
# See https://wiki.hyprland.org/Configuring/Keywords/#executing for more
misc {
    disable_hyprland_logo = false
}

#---------------------------------------------------------------------------------------
# ПРАВИЛА ДЛЯ ВОРКСПЕЙСА 
#---------------------------------------------------------------------------------------

workspace = special:minimized, gapsin:30, gapsout:30, layoutmsg:orientation:top, on-created-empty: pavucontrol

# Замена no_gaps_only (В новой версии сделали гибкую систему)
workspace = w[tv1]s[false], gapsout:0, gapsin:0, decorate:0
workspace = f[1]s[false], gapsout:0, gapsin:0
windowrule = bordersize 0, floating:0, onworkspace:w[tv1]s[false]
windowrule = rounding 0, floating:0, onworkspace:w[tv1]s[false]
windowrule = bordersize 0, floating:0, onworkspace:f[1]s[false]
windowrule = rounding 0, floating:0, onworkspace:f[1]s[false]

workspace = 1, monitor:eDP-1
workspace = 2, monitor:eDP-1
workspace = 3, monitor:eDP-1
workspace = 4, monitor:eDP-1
workspace = 5, monitor:eDP-1
workspace = 6, monitor:eDP-1
workspace = 7, monitor:eDP-1
workspace = 8, monitor:eDP-1

workspace = 9,  monitor:HDMI-A-1
workspace = 10, monitor:HDMI-A-1
workspace = 11, monitor:HDMI-A-1
workspace = 12, monitor:HDMI-A-1
workspace = 13, monitor:HDMI-A-1
workspace = 14, monitor:HDMI-A-1
workspace = 15, monitor:HDMI-A-1
workspace = 16, monitor:HDMI-A-1

#---------------------------------------------------------------------------------------
# ПРАВИЛА ОКОН (hyprctl clients - так можно узнать класс окна)
#---------------------------------------------------------------------------------------
# Больше параметров тут: https://wiki.hyprland.org/Configuring/Window-Rules/

windowrule = nodim, class:GLava)
windowrule = noblur, class:GLava$

windowrule = float, class:Electron
windowrule = move 5% 5%, class:Electron
windowrule = size 90% 90%, class:Electron

windowrule = workspace 1, class:Firefox, floating:0 
windowrule = nodim, class:Firefox
windowrule = float, class:Firefox), title:Картинка в картинке)

windowrule = workspace 1, class:zen, floating:0 
windowrule = nodim, class:zen
windowrule = float, class:zen), title:Картинка в картинке)

windowrule = workspace 1, class:waterfox, floating:0
windowrule = nodim, class:waterfox
windowrule = float, class:waterfox), title:Картинка в картинке)

windowrule = nodim, class:Alacritty
# windowrule = noblur, class:Alacritty

windowrule = workspace 4, class:Spotify
windowrule = workspace 4, class:yandex-music
windowrule = workspace 4, class:org.pulseaudio.pavucontrol
windowrule = workspace 4, class:com.github.wwmm.easyeffects

windowrule = workspace 6, class:steam

windowrule = workspace 3, class:Code - OSS
windowrule = workspace 3, class:jetbrains-idea-ce

windowrule = nodim, class:jetbrains-idea-ce

windowrule = workspace 5, title:(Telegram)(.*), class:org.telegram.desktop
windowrule = float, title:Просмотр медиа, class:org.telegram.desktop
windowrule = move 0% 0%, title:Просмотр медиа, class:org.telegram.desktop
windowrule = size 100% 100%, title:Просмотр медиа, class:org.telegram.desktop
windowrule = noborder, title:Просмотр медиа, class:org.telegram.desktop
windowrule = rounding 0, title:Просмотр медиа, class:org.telegram.desktop

windowrule = workspace 5, class:discord
windowrule = move 5% 5%, class:discord
windowrule = size 90% 90%, class:discord

windowrule = workspace 4, class:yandex-music

windowrule = float,class:mpv
windowrule = move 5% 5%, class:mpv
windowrule = size 90% 90%, class:mpv

windowrule = float, class:Nsxiv
windowrule = move 5% 5%, class:Nsxiv
windowrule = size 90% 90%, class:Nsxiv

windowrule = float,class:io.github.alainm23.planify
windowrule = size 500 900, class:io.github.alainm23.planify

windowrule = float,class:obsidian
windowrule = move 5% 5%, class:obsidian
windowrule = size 90% 90%, class:obsidian

windowrule = workspace 15, class:koodo-reader
windowrule = float,class:koodo-reader
windowrule = nodim, class:koodo-reader
windowrule = move 5% 5%, class:koodo-reader
windowrule = size 90% 90%, class:koodo-reader

windowrule = workspace 6, class:lutris
windowrule = float, class:lutris
windowrule = move 5% 5%, class:lutris
windowrule = size 90% 90%, class:lutris

windowrule = workspace 8, class:com.seafile.seafile-applet
windowrule = float, class:com.seafile.seafile-applet
windowrule = move 5% 5%, class:com.seafile.seafile-applet
windowrule = size 90% 90%, class:com.seafile.seafile-applet

windowrule = workspace 8, class:org.gnome.Nautilus
windowrule = float, class:org.gnome.Nautilus
windowrule = move 5% 5%, class:org.gnome.Nautilus
windowrule = size 90% 90%, class:org.gnome.Nautilus


windowrule = opacity 0.90 0.90,class:Alacritty
windowrule = opacity 0.90 0.90,class:Vivaldi-stable
windowrule = opacity 0.95 0.95,class:Firefox
windowrule = opacity 0.95 0.95,class:waterfox
windowrule = opacity 0.80 0.80,class:Steam
windowrule = opacity 0.80 0.80,class:steam
windowrule = opacity 0.80 0.80,class:steamwebhelper
windowrule = opacity 0.70 0.70,class:Spotify
windowrule = opacity 0.70 0.70,class:yandex-music
windowrule = opacity 0.90 0.90,class:Code - OSS
windowrule = opacity 0.90 0.90,class:jetbrains-idea-ce
windowrule = opacity 0.80 0.80,class:kitty
windowrule = opacity 0.80 0.80,class:org.kde.dolphin
windowrule = opacity 0.80 0.80,class:org.gnome.Nautilus
windowrule = opacity 0.80 0.80,class:org.kde.ark
windowrule = opacity 0.80 0.80,class:nwg-look
windowrule = opacity 0.80 0.80,class:qt5ct
windowrule = opacity 0.80 0.80,class:org.telegram.desktop

windowrule = opacity 0.90 0.90,class:com.github.rafostar.Clapper #Clapper-Gtk
windowrule = opacity 0.80 0.80,class:com.github.tchx84.Flatseal #Flatseal-Gtk
windowrule = opacity 0.80 0.80,class:hu.kramo.Cartridges #Cartridges-Gtk
windowrule = opacity 0.80 0.80,class:com.obsproject.Studio #Obs-Qt
windowrule = opacity 0.80 0.80,class:gnome-boxes #Boxes-Gtk
windowrule = opacity 0.80 0.80,class:discord #Discord-Electron
windowrule = opacity 0.80 0.80,class:WebCord #WebCord-Electron
windowrule = opacity 0.80 0.80,class:app.drey.Warp #Warp-Gtk
windowrule = opacity 0.80 0.80,class:net.davidotek.pupgui2 #ProtonUp-Qt
windowrule = opacity 0.80 0.80,class:yad #Protontricks-Gtk
windowrule = opacity 0.80 0.80,class:koodo-reader

windowrule = opacity 0.80 0.70,class:pavucontrol
windowrule = opacity 0.80 0.70,class:blueman-manager
windowrule = opacity 0.80 0.70,class:nm-applet
windowrule = opacity 0.80 0.70,class:nm-connection-editor
windowrule = opacity 0.80 0.70,class:lxqt-policykit-agent
windowrule = opacity 1 1,class:vlc

windowrule = float,class:org.kde.ark
windowrule = float,class:com.github.rafostar.Clapper #Clapper-Gtk
windowrule = float,class:app.drey.Warp #Warp-Gtk
windowrule = float,class:net.davidotek.pupgui2 #ProtonUp-Qt
windowrule = float,class:yad #Protontricks-Gtk
windowrule = float,class:pavucontrol
windowrule = float,class:blueman-manager
windowrule = float,class:nm-applet
windowrule = float,class:nm-connection-editor
windowrule = float,class:lxqt-policykit-agent

#---------------------------------------------------------------------------------------
# ПРАВИЛА СЛОЕВ
#---------------------------------------------------------------------------------------
layerrule = blur, waybar
layerrule = blur, fabric
layerrule = blur, quickshell
# layerrule = blur, notifications

#---------------------------------------------------------------------------------------
# ХОТКЕИ
#---------------------------------------------------------------------------------------

binds {
    workspace_back_and_forth = true   
}

binds = Super_L, M&S, exit, 
bind = $mainMod, F, fullscreen, 
bind = $mainMod, W, exec, $wallpaper
bind = $mainMod, PRINT, exec, ~/.config/hypr/scripts/Hyprshot/hyprshot -m region
bind =  , PRINT, exec, ~/.config/hypr/scripts/Hyprshot/hyprshot -m output
bind = $mainMod, N, exec, [float] alacritty -t nm-wifi-menu -e "nmtui"
bind = $mainMod, D, exec, pkill tofi || tofi-drun --output "eDP-1" --drun-launch=true
bind = SUPER, V, exec, pkill tofi || cliphist list | tofi --output "eDP-1" | cliphist decode | wl-copy
bind = $mainMod, F1, exec, ~/.config/hypr/scripts/gamemode.sh

# Переключение на другой воркспейс скролом мыши с зажатым mainMod
bind = $mainMod, mouse_down, workspace, e+1
bind = $mainMod, mouse_up, workspace, e-1

# Перемещение и ресайз окон ЛКМ ПКМ + mineMod
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow

# Управление фокусом
bind = $mainMod, H, movefocus, l
bind = $mainMod, L, movefocus, r
bind = $mainMod, K, movefocus, u
bind = $mainMod, J, movefocus, d
bind = $mainMod, C, cyclenext

# Переключение воркспейсов
bind = $mainMod, 1, exec, ~/.config/hypr/scripts/toworkspace 1 8
bind = $mainMod, 2, exec, ~/.config/hypr/scripts/toworkspace 2 8
bind = $mainMod, 3, exec, ~/.config/hypr/scripts/toworkspace 3 8
bind = $mainMod, 4, exec, ~/.config/hypr/scripts/toworkspace 4 8
bind = $mainMod, 5, exec, ~/.config/hypr/scripts/toworkspace 5 8
bind = $mainMod, 6, exec, ~/.config/hypr/scripts/toworkspace 6 8
bind = $mainMod, 7, exec, ~/.config/hypr/scripts/toworkspace 7 8
bind = $mainMod, 8, exec, ~/.config/hypr/scripts/toworkspace 8 8

# Перемещение окна между мониторами
bind = $mainMod CTRL, 1, movetoworkspace, -8
bind = $mainMod CTRL, 2, movetoworkspace, +8

# Специальный воркспейс для свернутых приложений
bind = $mainMod, TAB, togglespecialworkspace, minimized

# Сворачивание окна
bind = $mainMod SHIFT, TAB, movetoworkspace, special:minimized
bind = $mainMod SHIFT, TAB, togglespecialworkspace, minimized

# Разворачние окна
bind = $mainMod CTRL, TAB, movetoworkspace, +0

# Блокировка перехода курсора на второй монитор
binds = Super_L, M&L, exec, ~/.config/hypr/scripts/monitors/toggle_mouselock_monitor

# Управление layout
bind = $mainMod SHIFT, A, layoutmsg, addmaster 	          # master
bind = $mainMod SHIFT, T, layoutmsg, orientationtop       # master
bind = $mainMod SHIFT, L, layoutmsg, orientationleft      # master
bind = $mainMod SHIFT, R, layoutmsg, orientationright     # master
bind = $mainMod SHIFT, B, layoutmsg, orientationbottom    # master
bind = $mainMod SHIFT, D, layoutmsg, removemaster 	      # master
bind = $mainMod SHIFT, S, layoutmsg, swapwithmaster       # master
bind = $mainMod SHIFT, SPACE, togglefloating 
bind = $mainMod SHIFT, P, pin
bind = $mainMod SHIFT, Q, killactive, 

# Перемещение окна на другой воркспейс
bind = $mainMod SHIFT, 1, split-movetoworkspace, 1
bind = $mainMod SHIFT, 2, split-movetoworkspace, 2
bind = $mainMod SHIFT, 3, split-movetoworkspace, 3
bind = $mainMod SHIFT, 4, split-movetoworkspace, 4
bind = $mainMod SHIFT, 5, split-movetoworkspace, 5
bind = $mainMod SHIFT, 6, split-movetoworkspace, 6
bind = $mainMod SHIFT, 7, split-movetoworkspace, 7
bind = $mainMod SHIFT, 8, split-movetoworkspace, 8

# Поворот второго монитора
bind = $mainMod SHIFT, V, exec, ~/.config/hypr/scripts/monitors/orientation_keeper 1
bind = $mainMod SHIFT, H, exec, ~/.config/hypr/scripts/monitors/orientation_keeper 0

# Ресайз
bind = $mainMod SHIFT, left, resizeactive,-50 0
bind = $mainMod SHIFT, right, resizeactive,50 0
bind = $mainMod SHIFT, up, resizeactive,0 -50
bind = $mainMod SHIFT, down, resizeactive,0 50

# Запуск софта
bind = $mainMod, RETURN, exec, ~/.config/hypr/scripts/execonmonitor 2 alacritty
bind = $mainMod CTRL, C, exec, code-oss
bind = $mainMod CTRL, B, exec, $browser
bind = $mainMod CTRL, R, exec, krita
bind = $mainMod CTRL, O, exec, gtk-launch obsidian
bind = $mainMod CTRL, H, exec, [float] alacritty --config-file=/home/dallinchi/.config/alacritty/hestale.toml -T "Hestale - Password Generator" -e hestale -r
bind = $mainMod CTRL, E, exec, [float] alacritty -T "Alacritty - Ranger" -e 'ranger'
bind = $mainMod CTRL, V, exec, [workspace special:minimized] alacritty -e /home/dallinchi/Documents/vpns/OpenConnect/connect
bind = $mainMod CTRL, P, exec, python ~/Code/Projects/cli-timer-delay -r -a 'alert' -d 40
bind = $mainMod CTRL, M, exec, yandex-music
bind = $mainMod CTRL, T, exec, telegram-desktop
bind = $mainMod CTRL, D, exec, gtk-launch Discord
bind = $mainMod CTRL, K, exec, koodo-reader
bind = $mainMod CTRL, I, exec, ~/.config/hypr/scripts/bar-toggle
bind = $mainMod CTRL, PRINT, exec, [float] alacritty -e "make-screencast"

# Категории нет. Прикольные штуксы?
bind = $mainMod ALT, N, exec, playerctl next 
bind = $mainMod ALT, P, exec, playerctl previous 
bind = $mainMod ALT, K, exec, playerctl play-pause 

# Спец-клавиши
bind =, XF86AudioRaiseVolume, exec, pactl set-sink-volume @DEFAULT_SINK@ +5%
bind =, XF86AudioLowerVolume, exec, pactl set-sink-volume @DEFAULT_SINK@ -5%
bind =, XF86AudioMute, exec, pactl set-sink-mute @DEFAULT_SINK@ toggle
bind =, XF86AudioMicMute, exec, pactl set-source-mute @DEFAULT_SOURCE@ toggle
bind =, XF86MonBrightnessDown, exec, brightnessctl set 5%-
bind =, XF86MonBrightnessUp, exec, brightnessctl set 5%+
bind =, XF86AudioPlay, exec, playerctl play-pause
bind =, XF86AudioNext, exec, playerctl next
bind =, XF86AudioPrev, exec, playerctl previous
bind =, XF86Search, exec, bemenu-run

#---------------------------------------------------------------------------------------
# ПЛАГИНЫ
#---------------------------------------------------------------------------------------
plugin {
    split-monitor-workspaces {
        count = 8
        keep_focused = 1
        enable_notifications = 0
        enable_persistent_workspaces = 0
    }
}

